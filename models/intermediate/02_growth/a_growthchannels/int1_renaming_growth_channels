with subscribers as (
    select * from {{ref('stg_subscribers')}}
),

dojo as (
    select 
        EMAIL,
        LEADID,
        list_ID,
        date_status_changed,
        STATUS,
        CASE WHEN (Growth_Channel ILIKE '%DojoMojo%' or campaign_name IS NOT NULL) and source_brand != 'The GIST' THEN 'Dojo' END,
        Country,
        CITIES,
        referral_code,
        referral_count,
        campaign_name,
        source_brand
    from subscribers
    WHERE (Growth_Channel ILIKE '%DojoMojo%' or campaign_name IS NOT NULL) and source_brand != 'The GIST'
), 

coreg as (
    select 
        EMAIL,
        LEADID,
        list_ID,
        date_status_changed,
        STATUS,
        CASE WHEN Growth_Channel ILIKE '%CoReg%' and (Growth_Channel not ilike '%mowMedia%' or Growth_Channel not ilike '%testMow%' or Growth_Channel not ilike '%NexxtHP%' or Growth_Channel not ilike '%CoReg-Campaign-testMow%') THEN 'CoReg' END,
        Country,
        CITIES,
        referral_code,
        referral_count,
        campaign_name,
        source_brand
    from subscribers
    WHERE Growth_Channel ILIKE '%CoReg%' and (Growth_Channel not ilike '%mowMedia%' or Growth_Channel not ilike '%testMow%' or Growth_Channel not ilike '%NexxtHP%' or Growth_Channel not ilike '%CoReg-Campaign-testMow%')
), 

influencer as (
    select 
        EMAIL,
        LEADID,
        list_ID,
        date_status_changed,
        STATUS,
        CASE WHEN Growth_Channel ILIKE '%Ambassador%' THEN 'Affiliate/Influencer' END,
        Country,
        CITIES,
        referral_code,
        referral_count,
        campaign_name,
        source_brand
    from subscribers
    WHERE Growth_Channel ILIKE '%Ambassador%'
), 

growth_from_socials as (
    select 
        EMAIL,
        LEADID,
        list_ID,
        date_status_changed,
        STATUS,
        CASE WHEN Growth_Channel ILIKE '%unpaid%' and Growth_Channel ILIKE '%socialmedia%' THEN 'Growth from Socials' END,
        Country,
        CITIES,
        referral_code,
        referral_count,
        campaign_name,
        source_brand
    from subscribers
    WHERE Growth_Channel ILIKE '%unpaid%' and Growth_Channel ILIKE '%socialmedia%'
), 

host_post as (
    select 
        EMAIL,
        LEADID,
        list_ID,
        date_status_changed,
        STATUS,
        CASE WHEN Growth_Channel ilike '%mowMedia%' or Growth_Channel ilike '%testMow%' or Growth_Channel ilike '%NexxtHP%' or Growth_Channel ilike '%CoReg-Campaign-testMow%' THEN 'Host & Post' END,
        Country,
        CITIES,
        referral_code,
        referral_count,
        campaign_name,
        source_brand
    from subscribers
    WHERE Growth_Channel ilike '%mowMedia%' or Growth_Channel ilike '%testMow%' or Growth_Channel ilike '%NexxtHP%' or Growth_Channel ilike '%CoReg-Campaign-testMow%'
), 

newsletters as (
    select 
        EMAIL,
        LEADID,
        list_ID,
        date_status_changed,
        STATUS,
        CASE WHEN Growth_Channel ilike '%newsletter%' THEN 'Newsletters' END,
        Country,
        CITIES,
        referral_code,
        referral_count,
        campaign_name,
        source_brand
    from subscribers
    WHERE Growth_Channel ilike '%newsletter%'
), 

other_contests as (
    select 
        EMAIL,
        LEADID,
        list_ID,
        date_status_changed,
        STATUS,
        CASE WHEN (Growth_Channel not ilike '%dojomojo%' or Growth_Channel not ilike '%socialmedia%') and Growth_Channel ilike '%contest%' THEN 'Other Contests' END,
        Country,
        CITIES,
        referral_code,
        referral_count,
        campaign_name,
        source_brand
    from subscribers
    WHERE (Growth_Channel not ilike '%dojomojo%' or Growth_Channel not ilike '%socialmedia%') and Growth_Channel ilike '%contest%'
), 
